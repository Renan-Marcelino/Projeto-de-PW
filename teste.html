<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Login com Planilha Google Sheets</title>
</head>
<body>
    <h1>Login com Planilha Google Sheets</h1>
    <form id="login-form">
        <input type="text" id="email" placeholder="Email">
        <input type="password" id="senha" placeholder="Senha">
        <button type="button" onclick="verificarLogin()">Login</button>
    </form>
    <p id="resultado"></p>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-xlsx/0.15.1/xlsx.full.min.js"></script>
    <script src="https://apis.google.com/js/api.js" onload="handleClientLoad()"></script>
    <script>
        var SPREADSHEET_ID = '1WpkURllvmMnC8mABE70af7tE__UGzT2cQ7PN9SqnfAY';
        var SHEET_NAME = 'Sheet1'; // Nome da aba da planilha

        var usuarios = [];

        function handleClientLoad() {
            gapi.load('client:auth2', initClient);
        }

        function initClient() {
            gapi.client.init({
                apiKey: 'SUA_API_KEY',
                clientId: 'SEU_CLIENT_ID',
                discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
                scope: "https://www.googleapis.com/auth/spreadsheets.readonly"
            }).then(function () {
                loadSheetData();
            });
        }

        function loadSheetData() {
            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: SPREADSHEET_ID,
                range: SHEET_NAME
            }).then(function(response) {
                var range = response.result;
                if (range && range.values) {
                    usuarios = range.values.map(function(row) {
                        return {
                            email: row[0], // A primeira coluna contém o email
                            senha: row[1]  // A segunda coluna contém a senha
                        };
                    });
                }
            });
        }

        function verificarLogin() {
            var email = document.getElementById('email').value;
            var senha = document.getElementById('senha').value;
            var credenciaisCorretas = false;

            for (var i = 0; i < usuarios.length; i++) {
                if (usuarios[i].email === email && usuarios[i].senha === senha) {
                    credenciaisCorretas = true;
                    break;
                }
            }

            if (credenciaisCorretas) {
                document.getElementById('resultado').textContent = "Login bem-sucedido. Acesso permitido.";
            } else {
                document.getElementById('resultado').textContent = "Credenciais incorretas. Acesso negado.";
            }
        }
    </script>
</body>
</html>
